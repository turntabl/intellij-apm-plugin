<!DOCTYPE html>
<html lang="en">

<head>

    <link href="http://getbootstrap.com/dist/css/bootstrap.min.css" rel="stylesheet">

    <link href="http://getbootstrap.com/examples/justified-nav/justified-nav.css" rel="stylesheet">

    <script src="http://d3js.org/d3.v5.min.js" charset="utf-8"></script>
    <style>
        .axis path {
            fill: none;
            stroke: #777;
            shape-rendering: crispEdges;
        }
        .axis text {
            font-family: Lato;
            font-size: 13px;
        }
    </style>
</head>

<body>
<center>
    <div class="container">
        <h2>CPU Load Graph</h2>
        <div class="jumbotron">
            <svg id="chart" width="1000" height="500"></svg>
        </div>
        <span>X-axis: Timestamp&nbsp;&nbsp;&nbsp;&nbsp;Y-axis: Values</span>
        <div style="display: flex; flex-direction: row; justify-content: space-evenly;">
            <h4 style="color: green;">JVM User</h4>
            <h4 style="color: blue;">JVM System</h4>
            <h4 style="color: red;">Machine Total</h4>
        </div>
    </div>
</center>
<script>
    var data = [{
        "timestamp":1619441634964, 
        "type":"gauge", 
        "jvmUserValue":0.10448416322469711,
        "jvmSystemValue":0.0217414027824997902,
        "machineTotalValue":0.57614521086215973,
        "attributes":{}
    },
    {
        "timestamp":1619442634964, 
        "type":"gauge", 
        "jvmUserValue":0.20448416322469711,
        "jvmSystemValue":0.017414027824997902,
        "machineTotalValue":0.47614521086215973,
        "attributes":{}
    },
    {
        "timestamp":1619443634964, 
        "type":"gauge", 
        "jvmUserValue":0.30448416322469711,
        "jvmSystemValue":0.047414027824997902,
        "machineTotalValue":0.37614521086215973,
        "attributes":{}
    },
    {
        "timestamp":1619444634964, 
        "type":"gauge", 
        "jvmUserValue":0.40448416322469711,
        "jvmSystemValue":0.07414027824997902,
        "machineTotalValue":0.27614521086215973,
        "attributes":{}
    },
    {
        "timestamp":1619445634964, 
        "type":"gauge", 
        "jvmUserValue":0.50448416322469711,
        "jvmSystemValue":0.037414027824997902,
        "machineTotalValue":0.17614521086215973,
        "attributes":{}
    }];

    function chart(data) {
        data.forEach(function(d) {
            var date = new Date(d.timestamp);
            d.timestamp = date;
            return d;
        });

        var svg = d3.select("#chart"),
        margin = {top: 20, right: 20, bottom: 20, left: 50},
        width = +svg.attr("width") - margin.left - margin.right,
        height = +svg.attr("height") - margin.top - margin.bottom;

        var x = d3.scaleTime()
            .rangeRound([margin.left, width - margin.right])
            .domain(d3.extent(data, d => d.timestamp));

        var y = d3.scaleLinear()
            .rangeRound([height - margin.bottom, margin.top]);

        var z = d3.scaleOrdinal(d3.schemeCategory10);

        var line = d3.line()
		.curve(d3.curveCardinal)
		.x(d => x(d.timestamp))
		.y(d => y(d.jvmUserValue));

        var line2 = d3.line()
		.curve(d3.curveCardinal)
		.x(d => x(d.timestamp))
		.y(d => y(d.jvmSystemValue));

        var line3 = d3.line()
		.curve(d3.curveCardinal)
		.x(d => x(d.timestamp))
		.y(d => y(d.machineTotalValue));

        svg.append("g")
            .attr("class","x-axis")
            .attr("transform", "translate(0," + (height - margin.bottom) + ")")
            .call(d3.axisBottom(x).tickFormat(d3.timeFormat("%H:%M:%S")))
            .append("text")
            .attr("x", 500)
            .attr("y", 0)
            .text("Timestamp");

	    svg.append("g")
            .attr("class", "y-axis")
            .attr("transform", "translate(" + margin.left + ",0)")
            .call(d3.axisLeft(y))
            .append("text")
            .attr("text-anchor", "end")
            .text("Values");

        svg.append('path')
            .attr('d', line(data))
            .attr('stroke', 'green')
            .attr('stroke-width', 2)
            .attr('fill', 'none');
    	
        svg.append('path')
            .attr('d', line2(data))
            .attr('stroke', 'blue')
            .attr('stroke-width', 2)
            .attr('fill', 'none');

        svg.append('path')
            .attr('d', line3(data))
            .attr('stroke', 'red')
            .attr('stroke-width', 2)
            .attr('fill', 'none');    
    }

    chart(data);
</script>